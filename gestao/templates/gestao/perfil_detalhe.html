{% extends "parciais/base_dashboard.html" %}
{% load omfilters %}

{% block titulo %}Detalhes{% endblock %}

{% block content %}
<main>


  <div class="pt-6 px-4">
    <div class="grid grid-cols-1 2xl:grid-cols-2 xl:gap-4 my-4">
      <!-- Sessions by device Card -->
      <div class="bg-white shadow rounded-lg p-4 sm:p-6 xl:p-8 "><br><br><br><br><br><br>

        <!-- Card Title -->
        <h4 class="text-lg leading-none font-bold text-gray-900 mt-8 mb-4">Filtrar por data:</h4>
        <form method="get">
          <div class="flex mb-4 grid justify-content-start align-items-center">
            <label for="data_inicio" class="mr-2">Início:</label>
            <input type="text" name="data_inicio" id="data_inicio" class="px-2 py-1 border rounded datepicker"
              autocomplete="off" value="{{ request.GET.data_inicio }}">
            <label for="data_fim" class="ml-4 mr-2">Fim:</label>
            <input type="text" name="data_fim" id="data_fim" class="px-2 py-1 border rounded datepicker"
              autocomplete="off" value="{{ request.GET.data_fim }}">
            <button type="submit" class="mr-2 px-4 py-1 bg-blue-500 text-black rounded">Filtrar</button>
            <button type="submit" class="mr-2 px-4 py-1 bg-blue-500 text-black rounded">
            </button>
          </div>
        </form>
        <h3 class="text-xl leading-none font-bold text-gray-900 mb-10">Detalhes do Perfil</h3>

        <p>Nome: {{ perfil.usuario }}</p>
        <!-- Adicione aqui outros detalhes do perfil -->

        <h4 class="text-lg leading-none font-bold text-gray-900 mt-8 mb-4">Selecione o tipo de venda:</h4>
        <p>
          <a href="{% url 'gestao:perfil_detalhe_tipo_venda' perfil.id 'V' %}">Vendas no Varejo</a> |
          <a href="{% url 'gestao:perfil_detalhe_tipo_venda' perfil.id 'A' %}">Vendas no Atacado</a>
        </p>

        {% if tipo_venda %}
        {% if tipo_venda == 'V' %}
        <h4 class="text-lg leading-none font-bold text-gray-900 mt-8 mb-4">Compras no Varejo</h4>
        {% elif tipo_venda == 'A' %}
        <h4 class="text-lg leading-none font-bold text-gray-900 mt-8 mb-4">Compras no Atacado</h4>
        {% endif %}
        {% if tipo_venda %}
        {% if tipo_venda == 'V' %}
        <p>Total Varejo: R$ {{ total_varejo }}</p>
        <p>Quantidade Varejo: {{ quantidade_varejo }}</p>

        {% elif tipo_venda == 'A' %}
        <p>Total Atacado: R$ {{ total_atacado }}</p>
        <p>Quantidade Atacado: {{ quantidade_atacado }}</p>

        {% endif %}
        {% endif %}
        {% if itens_pedido %}
        <table class="items-center w-full bg-transparent border-collapse">
          <thead>
            <tr>
              <th
                class="px-2 py-2 bg-gray-50 text-gray-700 align-middle text-xs font-semibold text-left uppercase border-l-0 border-r-0 whitespace-nowrap">
                Produto
              </th>
              <th
                class="px-2 py-2 bg-gray-50 text-gray-700 align-middle text-xs font-semibold text-left uppercase border-l-0 border-r-0 whitespace-nowrap">
                Quantidade
              </th>
              <th
                class="px-2 py-2 bg-gray-50 text-gray-700 align-middle text-xs font-semibold text-left uppercase border-l-0 border-r-0 whitespace-nowrap">
                Preço
              </th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100">
            {% for item_pedido in itens_pedido %}
            <tr class="text-gray-500">
              <th class="border-t-0 px-2 py-2 align-middle text-sm font-normal whitespace-nowrap">
                {{ item_pedido.produto }}-{{ item_pedido.produto_cor }}
              </th>
              <td class="border-t-0 px-2 py-2 align-middle text-xs font-medium text-gray-900 whitespace-nowrap">
                {{ item_pedido.quantidade }}
              </td>
              {% if item_pedido.preco_promocional %}
              <td class="border-t-0 px-2 py-2 align-middle text-xs font-medium text-gray-900 whitespace-nowrap">
                {{ item_pedido.preco_promocional|formata_preco }}
              </td>
              {% else %}
              <td class="border-t-0 px-2 py-2 align-middle text-xs font-medium text-gray-900 whitespace-nowrap">
                {{ item_pedido.preco|formata_preco }}
              </td>
              {% endif %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% else %}
        <p>Nenhum item do pedido encontrado para este tipo de venda.</p>
        {% endif %}
        {% endif %}



      </div>

    </div>

  </div>



</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/js/bootstrap-datepicker.min.js"></script>
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/locales/bootstrap-datepicker.pt-BR.min.js"></script>
<script>
  $(document).ready(function () {
    $('.datepicker').datepicker({
      format: 'dd/mm/yyyy',
      autoclose: true,
      todayHighlight: true,
      language: 'pt-BR'
    });
  });
</script>
{% endblock %}